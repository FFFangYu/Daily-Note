### 🅰XSS

恶意攻击者往**WEB页面插入恶意Script代码**，当用户浏览该页之时，嵌入其中WEB里面的Script代码会被执行，从而达到恶意攻击用户的目的。

**这些操作一般可以完成**下面的事情：

1. 窃取Cookie
2. 监听用户行为，比如输入账号密码后直接发送到黑客服务器
3. 修改DOM伪造登入表单
4. 在页面中生成浮窗广告

通常**XSS攻击的实现**方式有：存储型、反射型和文档型。

1. **存储型**，将恶意脚本存储起来，然后再客户端执行这些脚本的时候，达到攻击效果。

2. 1. 常见场景是留言评论区提交一段脚本代码，如果前后端没有做好转义工作，那评论区内容存到了数据库，在页面渲染过程中直接执行，相当于执行一段未知逻辑的JS代码。

3. **反射型**，指的是恶意脚本作为网络请求的一部分。经过服务器，然后再反射到HTML文档中，执行解析。和存储型不同，服务器不会存储这些恶意脚本。

4. **文档型**，并不会经过服务器，而是作为中间人的角色，再数据传输过程劫持到网络数据包，然后修改里面的html文档

5. 1. WIFI路由劫持
   2. 本地恶意软件

**⭕防范措施**

- 千万不能相信用户的输入，要对用户的输入进行转码或者过滤

- 利用**CSP**（浏览器中的内容安全策略），核心思想是服务器决定浏览器加载哪些资源，具体可以完成：

- - 限制其他域下的资源加载
  - 禁止向其他域提交数据
  - 提供上报机制，能帮助我们及时发现XSS攻击

- 利用**HttpOnly**，很多XSS攻击是用来窃取Cookie，设置Cookie为HttpOnly后，JavaScript便无法读取Cookie值。

  

### 🅰XSRF

指的是黑客诱导用户点击链接，打开黑客的网站，然后黑客利用服务器的**验证漏洞**和**用户目前的登录状态**发起跨站请求。

**CSRF攻击一般有**：自动GET请求、自动POST请求、诱导点击发送GET请求

**自动发GET请求**

黑客网页中可能有这样一段代码：`<img src="https://xxx.com/info?user=hhh&count=100">`

进入页面后自动发送GET请求，值得注意的是，这个请求会自动带上关于xxx.com的cookie信息（假定已经再xxx.com中登入过）。

如果服务器没有相应的验证机制，它可能会认为是一个正常用户发送的请求，然后进行相应的个各种操作，可能是转账汇款以及其他恶意操作。

**自动发POST请求**

黑客可能自己填了一个表单，写了一段自动提交的脚本，同样会携带用户的cookie信息，让服务器以为是一个正常用户的操作，让各种恶意操作变为可能。

**诱导性点击发送GET请求**

在黑客的网站上，可能会放一个链接，趋势你点击，点击之后，自动发送GET请求，接下来和自动发GET请求部分同理。

**⭕防范措施**

1. 利用Cookie的samesite属性
   1. Strict模式下，浏览器**完全禁止**第三方请求携带Cookie
   2. Lax模式下，只在**get****方法提交表单**或者**a****标签发送get请求**的情况下可以携带Cookie。
   3. None模式下，也是默认模式，请求会**自动携带**上Coookie
2. 验证来源站点
   1. 需要用到请求头中的两个字段
   2. Origin，只包含域名信息
   3. Referer，包含具体的URL路径
   4. 这两者都是可以伪造，通过Ajax中自定义请求头即可，安全性略差
3. CSRF Token
   1. 首先，浏览器向服务器发送请求时，服务器生成一个字符串，将其植入到返回的页面中。
   2. 然后浏览器如果要发送请求，就必须带上这个字符串，然后服务器来验证是否合法，如果不合法则不予响应
   3. 这个字符就是CSRF Token，通常第三方站点无法拿到这个Token，因此就被服务器拒绝。



### 🅱区别

- 原理不同，CSRF是利用网站A本身的漏洞，去请求网站A的API；XSS是向目标网站注入JS代码，然后执行JS里面的代码。
- CSRF需要用户先登入目标网站获取cookie，而XSS不需要登入
- CSRF的目标是用户，XSS的目标是服务器
- XSS是利用合法用户获取其信息，而CSRF是伪造成合法用户发起请求